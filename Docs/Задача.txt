Проект в едином файле main.py
Все должнно работать на базовых фреймворках либо фреймворках и из базового комплекта Anaconda 3.90, тк PIP install совершить не получится (запрещено)

На вход подаются два файла XLSX
Из каталога IN в папке проекта
задаем имя файлов
Файл текущий (T-0): "АКТИВЫ 31-10-2025 (ОСТАТОК-V2).xlsx"
Файл прошлый (Т-1): "АКТИВЫ 31-12-2024 (ОСТАТОК-V2).xlsx"

внутри задаем в каждом из файлов
название листа: "Sheet1"
название используемых колонон:
Территориальный банк (ТБ/Тербарнк): "ТБ"
ГОСБ: "ГОСБ"
Клиентский менеджер (КМ): "ВКО"
Табельный номер Клиентсккого менеджера (ТН / TN): "Таб. номер ВКО"
ID Клиента: "ИНН"
Факт (сумма): "Остаток срочной задолженности по основному долгу"

Загружаем данные двух файлов

Необходимо корректно сравнить два файла по принципу 
Прирост = "Факт (Т-0)" - "Факт (Т-1)"

Логика сравнения:
будет несколько вариантов и их комбинаций
задаем двумя параметрами
1) Как определяем Клиентского менеджера: 
- на текущую дату: 
К ID клиента добавляем последнего имеющегося Клиентского менеджера и соответствующего ему табельный номер.
т.е. если есть у данного клиента КМ в файле (T-0) то берем для данного клиента его, если нет - то из файла (Т-1) Если и там нет, то ставим имя КМ "Не найден КМ" с ТН "90000009"
- на дату отчета:
Определяем КМ в каждом из двух файлов отдельно. те возможна ситуация что КМ у одного и того же клиента в разыных файлах будут разные.

2) Учитывать ли при расчете ТБ:
- Если ТБ не учитываем, то прирост счиитаем по ID + КМ
- если ТБ учитываем: то прирост считаем по ID + ТБ + КМ

Формат данынх при выводе в файлы задаем в параметарх названий колонок:



Перед обработкой файла надо очистить данные от некоторых данных
"ТБ" - текстовый
"ГОСБ" - текстовый
"ВКО" - текстовый
"Таб. номер ВКО" - преобразованный в текст число (это число из 8 знаков с лидирующими нулями: 85461 => "00085461"). надо задать лидирующий знак и число общее знаков, что б можно было например 10 знаков с лидирующем Х например
"ИНН" - преобразованный в текст число (это число из 12 знаков с лидирующими нулями: 7744459461 => "007744459461"). надо задать лидирующий знак и число общее знаков, что б можно было например 15 знаков с лидирующем Х например
Факт (сумма): число в формате разделенные разряды + "," + 2 знака после запятой
Если какое-то преобразоватние провести нельзя, например вместо числа для преобразования в поле текст, то надо перенести значение как есть.

Перед началом обработки надо в каждом файле удалить строки с определенными в параметре значениями
задаем имя колонки и в списке значения которые надо удалить (не чувствительно к регистру)
те например надо предварительно удалить строки где в колонке "ВКО" содержится текст: "-", "Серая зона"
"Таб. номер ВКО": "-", "Green_Zone", "Tech_Sib"
ID Клиента: "Report_id не определен"

При определении ТН и ВКО внутри файла если у одного ID несколько вариантов ВКО то выбираем ВКО у которого сумма Факта по строкам с таким же ВКО и таким же ID будет большем чем у других. Если сумма одинкковая, то выбираем любого из тех кто будет по данному клиенту

формируем список уникальных ID клиента из обоих файлов
1) ID
2) ID + ТБ
3) ID + Табельный
4) ID + ТБ + Табельный
к этим 4 листам (вариантам) надо подтянуть сумма по ФАКТу из обоих файлов по соответствующему ключу
И для каждой строки для каждого ID клиента в каждом из вариантов рассчитать прирост (формула выше)

Далее надо к листу подтянуть ВКО и его ТН по алгоритму 
1) ПРОСТО ВКО и ТН из файла 1 и файла 2 определенному по принципу максимум факт по указанному ключу
2) ВКО из последнего файла по указанному ключу (принцип кто последний тот и ВКО)



Далее надо создать еще лист на который надо собрать все уникальные ТН + ВКО
и лист ТН + ВКО + ТБ
Для каждого листа надо собрать сумму от предидущего листа по ТН
вариант 1 собираем приросты по ТН ВКО из последнего файла
вариант 2 приросты из каждого отдельно файла.

После надо сформировать лист для загрузки данных с колонками: (СПОД данные)

MANAGER_PERSON_NUMBER = Тебельный номер в формате 20 знаков с лидирующими нулями
CONTEST_CODE = "01_2025-2_14-1_2" - задаем параметром
TOURNAMENT_CODE = "t_01_2025-2_14-1_2_1001" - задаем параметром
CONTEST_DATE = "2025-10-31" - задеем параметром в виде даты "31/10/2025" которую надо представить в файле в виде "2025-10-31"
PLAN_VALUE = 0 (задается отдельным параметром) (формат: целая часть + "." + дробная чать из 5 знаков если знаков мало то справа добавляем 0:  0 => "0.00000")
FACT_VALUE = факту с листа по ТН+ВКО (формат: целая часть + "." + дробная чать из 5 знаков если знаков мало то справа добавляем 0:  43,51 => "43.51000")
priority_type    = "1"


Далее надо сохранить данные в Эксель.
для каждого листа надо сделать нужные форматы данных
Под каждый лист 1 строка с заголовком жирный текст и перенос по строкам
остальные колонки минимальная ширина 70, максимальная 200, а если умещается между то ставим что б по содержимому ширинра была
и также ставим переносить по словам.
Задаем для каждого листа какую строку столбец закреплять по умолчанию A2
В каждом листе включен автофильтр

ТАкже создаем файл под данные СПОД файлы в формате CSV с разделителем ";"

Имена выходных файлов и файлов логов должны содержать заданное в параметре начало имени и суфикс в виде таймШтампа: "_YYYYMMDD_HH_MM"


Общая задача, надо посчитать приросты по клиентам и корректно в зависимости от параметров привязать к приростам полученным Табельные номера.
И вывести данные итоговые по ТН в файлы

Логирование на уровне DEBUG должно быть подробным по каждой функции.
в консоль выводим всегда только INFO
